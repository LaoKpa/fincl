(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{190:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(23),o=a.n(l),i=(a(98),a(35)),s=a(84),c=a(9),u=a(10),d=a(12),m=a(11),h=a(13),E=a(85),p=a.n(E),f=a(86),y=a.n(f),g=a(51),b=a.n(g),C=a(3),w=a.n(C),v=(a(70),a(36)),k=a.n(v),S=a(191),O=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Introduction"),r.a.createElement("p",null,"In the following I'll briefly describe the ",r.a.createElement("code",null,"fincl")," pipeline, from the original 1-minute bars all the way through label generation, model fitting and validation as well as PnL simulation."),r.a.createElement("p",null,'Automating the entire process like I\'ve done here is not the way an actual trading strategy would likely be designed (since sub-steps such as feature importance research would be separated and tackled individually) but I chose the mantra of "build to learn" for the techniques described in "Advances in Financial Machine Learning" and learn I did while combining the various disparate techniques described in the book. And that is even without using sample weighing, Triple-Barrier methods, sophisticated bet sizing techniques or macro/entropy features.'),r.a.createElement("p",null,"To make the tool quick & easy-to-use I've precomputed all results and included them in the frontend payload."),r.a.createElement("p",null,"Results or methodologies are indicated via the colored bars below each step."),r.a.createElement("h4",null,"1. Load & sample bars"),r.a.createElement("p",null,"Load our bars, chunk them into dollar bars aiming to have 25 bars per day per symbol for the year 2019."),r.a.createElement(S.a,{now:100,label:"Dollar bars"}),r.a.createElement("h4",null,"2. Downsample"),r.a.createElement("p",null,"A 100-day volatility estimate is taken and used as the basis for a symmetric CUSUM filter. This reduces the amount of rows to be evaluated by our models by e.g. roughly 50% on equity indices. This means that a forecast horizon of 10 bars on the E-Mini futures in the year 2019 would equate to roughly 20 hourly time bars (25 volume bars per day downsampled to 12.5 bars per day) or a forecast horizon of about a day."),r.a.createElement(S.a,{striped:!0,now:100,label:"Downsampled events"}),r.a.createElement("h4",null,"3. Binarize"),r.a.createElement("p",null,"[include CUSUM chart] Binarize the rows, i.e. for every row determine a forward returns window which is then used to calculate that row's label (i.e. positive returns over the forward looking window as a ",r.a.createElement("code",null,1)," for the classifier)."),r.a.createElement(S.a,{striped:!0,now:100,label:"Downsampled events with fixed horizon timestamps into the future"}),r.a.createElement("h4",null,"4. Feature engineering"),r.a.createElement("p",null,'A features matrix is constructed. Further information on the specific features, their definitions and parameters can be found under the "Feature Importance" tab.'),r.a.createElement(S.a,{now:100,label:"Features computed on full dataset"}),r.a.createElement("h4",null,"5. Alpha"),r.a.createElement("p",null,"If meta-labeling we use a rudimentary primary model (such as a MA Crossover or BBands strategy in this case) which generates ",r.a.createElement("code",null,"{long,short}")," ",r.a.createElement("code",null,"{1,-1}")," labels which are then filtered through a ML classifier emitting ",r.a.createElement("code",null,"{follow,filter}")," ",r.a.createElement("code",null,"{1,0}")," signals. In the case of classical labeling this step does nothing and ",r.a.createElement("code",null,"{long,short}")," ",r.a.createElement("code",null,"{1,-1}")," signals are generated later. The BBands (trend-following) strategy goes long whenever the upper Bollinger Band is breached, and short for the lower, while the (mean-reverting) version does the opposite."),r.a.createElement("h4",null,"6. Make bins"),r.a.createElement("p",null,"In the case of meta-labeling we use the generated signals ",r.a.createElement("code",null,"{1,-1}")," to determine if the strategy generated positive returns and should be followed ",r.a.createElement("code",null,"{1}")," or not ",r.a.createElement("code",null,"{0}"),". These labels are then used as the y_truths for our ML classifier. In the case of classical labeling simple long/short returns are used to generate ",r.a.createElement("code",null,"{1,-1}")," labels."),r.a.createElement(S.a,{now:100,label:"Full dataset with features & truth labels"}),r.a.createElement("h4",null,"7. Train/Test split"),r.a.createElement("p",null,"Exclude rows from our engineered features which haven't completed the warmup for all feature columns and split the set 50/50 into train & test set."),r.a.createElement(S.a,null,r.a.createElement(S.a,{bsStyle:"success",now:50,key:1,label:"Train set"}),r.a.createElement(S.a,{bsStyle:"danger",now:50,key:2,label:"Test set"})),r.a.createElement("h4",null,"8. Feature importances"),r.a.createElement("p",null,"For every alpha we calculate parallelized MDA feature importances. This means that for every symbol we run a loop excluding one of the features and comparing how much worse our predictions get without that feature. This is done with purged K-Fold CV and the calculated feature importances are therefore out-of-sample and predictive (rather than explanatory like MDI feature importances). The per-symbol calculated features are then combined into one general set of feature importances across the investment universe."),r.a.createElement(S.a,null,r.a.createElement(S.a,{bsStyle:"success",now:40,key:1,label:"Train set"}),r.a.createElement(S.a,{bsStyle:"info",now:10,key:2,label:"Val. set"})),r.a.createElement(S.a,null,r.a.createElement(S.a,{bsStyle:"success",now:30,key:1,label:"Train set"}),r.a.createElement(S.a,{bsStyle:"info",now:10,key:2,label:"Val. set"}),r.a.createElement(S.a,{bsStyle:"success",now:10,key:3,label:"Train set"})),r.a.createElement(S.a,null,r.a.createElement(S.a,{bsStyle:"success",now:20,key:1,label:"Train set"}),r.a.createElement(S.a,{bsStyle:"info",now:10,key:2,label:"Val. set"}),r.a.createElement(S.a,{bsStyle:"success",now:20,key:3,label:"Train set"})),r.a.createElement(S.a,null,r.a.createElement(S.a,{bsStyle:"success",now:10,key:1,label:"Train set"}),r.a.createElement(S.a,{bsStyle:"info",now:10,key:2,label:"Val. set"}),r.a.createElement(S.a,{bsStyle:"success",now:30,key:3,label:"Train set"})),r.a.createElement(S.a,null,r.a.createElement(S.a,{bsStyle:"info",now:10,key:1,label:"Val. set"}),r.a.createElement(S.a,{bsStyle:"success",now:40,key:2,label:"Train set"})),r.a.createElement("h4",null,"9. Pick good features "),r.a.createElement("p",null,"Join the feature importances computed parallelized & per-symbol into one dataframe Pick features that help our classifier's predictive abilities"),r.a.createElement(S.a,null,r.a.createElement(S.a,{bsStyle:"success",now:50,key:1,label:"Train set without unimportant features"}),r.a.createElement(S.a,{bsStyle:"danger",now:50,key:2,label:"Test set without unimportant features"})),r.a.createElement("h4",null,"10. Model"),r.a.createElement("p",null,"Using Purged K-Fold CV on the train set alone we run a randomized Grid search to find the best set of hyper parameters which are then used for the final walk-forward validation run. The cross-validation strategy is the same as for the calculation of feature importances above."),r.a.createElement("h4",null,"11. Reports"),r.a.createElement("p",null,"The final model validation is done via purged walk-forward cross-validation. Any rows overlapping train & test sets are purged."),r.a.createElement("p",null,"Classification reports, F1 scores and confusion matrixes are generated for both the alpha- and model-generated labels."),r.a.createElement(S.a,null,r.a.createElement(S.a,{bsStyle:"success",now:59,key:1,label:"Train set"}),r.a.createElement(S.a,{bsStyle:"warning",now:1,key:2}),r.a.createElement(S.a,{bsStyle:"danger",now:10,key:3,label:"Test set"})),r.a.createElement(S.a,null,r.a.createElement(S.a,{bsStyle:"success",now:69,key:1,label:"Train set"}),r.a.createElement(S.a,{bsStyle:"warning",now:1,key:2}),r.a.createElement(S.a,{bsStyle:"danger",now:10,key:3,label:"Test set"})),r.a.createElement(S.a,null,r.a.createElement(S.a,{bsStyle:"success",now:79,key:1,label:"Train set"}),r.a.createElement(S.a,{bsStyle:"warning",now:1,key:2}),r.a.createElement(S.a,{bsStyle:"danger",now:10,key:3,label:"Test set"})),r.a.createElement(S.a,null,r.a.createElement(S.a,{bsStyle:"success",now:89,key:1,label:"Train set"}),r.a.createElement(S.a,{bsStyle:"warning",now:1,key:2}),r.a.createElement(S.a,{bsStyle:"danger",now:10,key:3,label:"Test set"})),r.a.createElement("h4",null,"12. Tearsheets"),r.a.createElement("p",null,'The average active signal is calculated and that series is then turned into a PnL graph with the trading logic / position sizing inspired by Thomas Schmelzer\'s 10-line-CTA. Performance stats, a drawndown table and a pyfolio returns tear-sheet are then generated (with the original strategy as the benchmark for meta-labeling, and a "long-all" Risk Parity like strategy for classical labeling).'),r.a.createElement(S.a,null,r.a.createElement(S.a,{className:"progress-bar-gray",now:60,key:1,label:""}),r.a.createElement(S.a,{bsStyle:"danger",now:40,key:2,label:"PnL report on test set"})),r.a.createElement("h3",null,"Weaknesses"),r.a.createElement("ul",null,r.a.createElement("li",null,"Large amounts of trials means a false discovery is likely"),r.a.createElement("li",null,"Trading costs are estimated rather optimistically at $1 per contract + a slippage of 25% of the mintick"),r.a.createElement("li",null,"No roll cost simulation"),r.a.createElement("li",null,"Differing base currencies are not taken into account"),r.a.createElement("li",null,"Coarse 1-minute bars are used as a base"),r.a.createElement("li",null,"Likely bugs in code (code was tested in units by hand only)")),r.a.createElement("h3",null,"Ideas for improvement"),r.a.createElement("ul",null,r.a.createElement("li",null,"Automatically verify stationarity of features (only done so by hand)"),r.a.createElement("li",null,"Dimensionality reduction (PCA, t-SNE)"),r.a.createElement("li",null,r.a.createElement("strong",null,"Develop & combine models:"),r.a.createElement("ul",null,r.a.createElement("li",null,"Develop additional models for time periods where the first round of models perform poorly"),r.a.createElement("li",null,"Develop additional models for different asset classes"),r.a.createElement("li",null,"Develop additional models that only go long / only go short"),r.a.createElement("li",null,"Develop additional models for different market regimes"),r.a.createElement("li",null,"Develop additional models that target different labels (such as change in volatility, skewness / kurtosis of returns, serial correlation)"),r.a.createElement("li",null,"Develop additional models with varying subsets of additional features"),r.a.createElement("li",null,"Use clustering to find unique models and select a diverse subset"),r.a.createElement("li",null,"Explore blending / stacking for all the above"))),r.a.createElement("li",null,"Auto-ML libraries (TPOT)"),r.a.createElement("li",null,"Compute Feature Importance in a stacked, rather than parallelized manner"),r.a.createElement("li",null,"Include non-micro-structural features (such as Entropy or Structural Breaks), in general the area of feature engineering has remained almost entirely unoptimized in an effort to get the general shape of the pipeline correct"),r.a.createElement("li",null,"CPCV on test set (Walk-Forward is chosen for simplicity' sake / to be reusable for the historical backtest)"),r.a.createElement("li",null,"Re-calculate feature importances and hyper parameters during final test set evaluation as well"),r.a.createElement("li",null,"Sample weighting (uniqueness weighting, sequential bootstrapping)"),r.a.createElement("li",null,"Use tick data rather than sampling from 1-minute bars"),r.a.createElement("li",null,"Add more data sources (such as VIX, options market data, fundamental data, yield curve data, etc.)"),r.a.createElement("li",null,"Try out different bar sampling methods (such as Dollar Imbalance Bars)"),r.a.createElement("li",null,"Try different roll methods for the futures contracts (IQFeed default continuous contract data is used)"),r.a.createElement("li",null,"Try more alphas (the MA-Cross & Bollinger Band strategies basically function as placeholders)"),r.a.createElement("li",null,"Try further ",r.a.createElement("code",null,"d")," values for Fractionally Differentiated Features (0.5 is used as a catch-all)"),r.a.createElement("li",null,"Try Target Encoding (i.e. a given feature is computed from a larger subset of the data rather than just the current instrument, say returns of the sector, or returns relative to the sector)"),r.a.createElement("li",null,"Try different targets for CUSUM downsampling (currently a 100-day EWM of the return's standard deviation is used)"),r.a.createElement("li",null,"Try a different bet sizing strategy (currently the average of active signals is used)"),r.a.createElement("li",null,"Explore different strategies/composed instruments (calendar spreads, curve steepeners, options structures etc.)"),r.a.createElement("li",null,"Explore GPU-accelerated learning (e.g. cuML, or GPU modes for XGBoost, LightGBM)"),r.a.createElement("li",null,"Browse Kaggle ML competitions / academic literature for new techniques to try")),r.a.createElement("h3",null,"Results"),r.a.createElement("ul",null,r.a.createElement("li",null,"Models tend to be biased to risk-on assets (as is natural with the market having an upwards bias)"),r.a.createElement("li",null,"Models show promising out-performance during bull periods. Combining models trained on different market regimes should lead to much more consistent performance."),r.a.createElement("li",null,"kNN outperforms in historical PnL simulations while scarcely performing better than random in the classification task."),r.a.createElement("li",null,"Random Forest is incredibly slow compared to XGBoost and LGBM, LGBM is much faster with at least on-par performance to the alternatives."),r.a.createElement("li",null,"Models tend to perform better on shorter forecast horizons."),r.a.createElement("li",null,"Meta-labeling manages to consistently improve the performance of a primary model by filtering it."),r.a.createElement("li",null,"XXX feature importance")),r.a.createElement("h3",null,"Inspiration & Thanks"),r.a.createElement("ul",null,r.a.createElement("li",null,"Marcel Lopez de Prado for his work on ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://www.amazon.com/Advances-Financial-Machine-Learning-Marcos/dp/1119482089"},"Advances in Financial Machine Learning"),". Learning & applying machine learning and the techniques in his book has consumed most my every working minute in the past 3 months. :)"),r.a.createElement("li",null,"Thomas Schmelzer for his work on ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://www.linkedin.com/pulse/implement-cta-less-than-10-lines-code-thomas-schmelzer/"},"10 line CTA"),". His code opened my eyes to the fact that (rough) PnL simulations can be done in a lot less code than libraries like quantopian's ",r.a.createElement("code",null,"zipline")," implied"),r.a.createElement("li",null,"Hudson & Thames for their work on ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/hudson-and-thames/mlfinlab/"},"mlfinlab")," which I used for their implementations of volume bar sampling & a few micro-structural features"),r.a.createElement("li",null,"Samuel Monnier for his work on ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/sam31415/timeseriescv"},"timeseriescv")," which I used for walk-forward testing"),r.a.createElement("li",null,"Ernest Chan for his tip in one of his podcasts (I don't recall which one) that he's found it a lot better to a beefy workstation at home than trying to do computations in the cloud. When you're renting spot instances in the cloud you're always asking yourself \"is it worth it?\"... In the process of working on ",r.a.createElement("code",null,"fincl")," I upgraded my 6-core Intel 9600K with 16GB of RAM PC to a 16-core AMD 3950x with 64GB of RAM. I love my new PC and having this thick workhorse sitting under my desk motivates me to always have some computation running over night :)")))}}]),t}(r.a.Component),F=a(32),M=a(31),x=a.n(M),T=a(192),I=a(197),j=a(193),B=a(194),A=a(195),P=a(53),L=k.a.questionSets[0].questions,N=w.a.fromPairs(w.a.map(L,(function(e){return[e.questionId,e]}))),G=w.a.fromPairs(w.a.map(N.classifier.input.options,(function(e){return[e.value,e.text]}))),D=function(e){if(w.a.isEmpty(e))return{};var t=w.a.filter(w.a.keys(e.data[0])),a=[],n=w.a.fromPairs(w.a.map(t,(function(e){return[e,[]]})));return w.a.forEach(e.data,(function(e){a.push(e[""]),w.a.forEach(t,(function(t){n[t].push(e[t])}))})),w.a.map(t,(function(e){var t=w.a.replace(e,"#C","");return{x:a,y:n[e],type:"scatter",name:P.Bloomberg[t]||t}}))},Q=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){if(w.a.isEmpty(this.props.data))return null;var e=this.props.data.confusion_matrix,t=this.props.data.classification_report,a=w.a.has(t,"0.0")?["0.0","1.0"]:["-1.0","1.0"],n=Object(F.a)(a,2),l=n[0],o=n[1],i=[w.a.split(l,".")[0],w.a.split(o,".")[0]],s=i[0],c=i[1];return r.a.createElement(T.a,{striped:!0,bordered:!0,condensed:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,"Predicted ",s),r.a.createElement("th",null,"Predicted ",c))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Label ",s),r.a.createElement("td",null,e[0][0]),r.a.createElement("td",null,e[0][1])),r.a.createElement("tr",null,r.a.createElement("td",null,"Label ",c),r.a.createElement("td",null,e[1][0]),r.a.createElement("td",null,e[1][1]))))}}]),t}(r.a.Component),_=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){if(w.a.isEmpty(this.props.data))return null;var e=this.props.data,t=w.a.has(e,"0.0")?["0.0","1.0"]:["-1.0","1.0"],a=Object(F.a)(t,2),n=a[0],l=a[1],o=[w.a.split(n,".")[0],w.a.split(l,".")[0]],i=o[0],s=o[1];return r.a.createElement(T.a,{striped:!0,bordered:!0,condensed:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,"Precision"),r.a.createElement("th",null,"Recall"),r.a.createElement("th",null,"F1-score"),r.a.createElement("th",null,"Support"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,i),r.a.createElement("td",null,e[n].precision.toFixed(3)),r.a.createElement("td",null,e[n].recall.toFixed(3)),r.a.createElement("td",null,e[n]["f1-score"].toFixed(3)),r.a.createElement("td",null,e[n].support)),r.a.createElement("tr",null,r.a.createElement("td",null,s),r.a.createElement("td",null,e[l].precision.toFixed(3)),r.a.createElement("td",null,e[l].recall.toFixed(3)),r.a.createElement("td",null,e[l]["f1-score"].toFixed(3)),r.a.createElement("td",null,e[l].support)),r.a.createElement("tr",null,r.a.createElement("td",null),r.a.createElement("td",null),r.a.createElement("td",null),r.a.createElement("td",null),r.a.createElement("td",null)),r.a.createElement("tr",null,r.a.createElement("td",null,"Accuracy"),r.a.createElement("td",null),r.a.createElement("td",null),r.a.createElement("td",null,e.accuracy.toFixed(3)),r.a.createElement("td",null,e["macro avg"].support)),r.a.createElement("tr",null,r.a.createElement("td",null,"Macro Avg."),r.a.createElement("td",null,e["macro avg"].precision.toFixed(3)),r.a.createElement("td",null,e["macro avg"].recall.toFixed(3)),r.a.createElement("td",null,e["macro avg"]["f1-score"].toFixed(3)),r.a.createElement("td",null,e["macro avg"].support)),r.a.createElement("tr",null,r.a.createElement("td",null,"Weighted Avg."),r.a.createElement("td",null,e["weighted avg"].precision.toFixed(3)),r.a.createElement("td",null,e["weighted avg"].recall.toFixed(3)),r.a.createElement("td",null,e["weighted avg"]["f1-score"].toFixed(3)),r.a.createElement("td",null,e["weighted avg"].support))))}}]),t}(r.a.Component),U=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement(T.a,{striped:!0,bordered:!0,condensed:!0,hover:!0},r.a.createElement("tbody",null,r.a.createElement("tr",null,w.a.isNull(this.props.roc_auc_score)?null:r.a.createElement("td",{className:"col-md-3"},"ROC AUC Score"),w.a.isNull(this.props.roc_auc_score)?null:r.a.createElement("td",{className:"col-md-3"},this.props.roc_auc_score.toFixed(3))),r.a.createElement("tr",null,w.a.isNull(this.props.f1_score)?null:r.a.createElement("td",{className:"col-md-3"},"F1 Score"),w.a.isNull(this.props.f1_score)?null:r.a.createElement("td",{className:"col-md-3"},this.props.f1_score.toFixed(3)))))}}]),t}(r.a.Component),q=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement(T.a,{striped:!0,bordered:!0,condensed:!0,hover:!0},r.a.createElement("tbody",null,w.a.map(this.props.data,(function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",{className:"col-md-3"},t),r.a.createElement("td",{className:"col-md-3"},e))}))))}}]),t}(r.a.Component),H=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.data,t=w.a.keys(e),a=w.a.keys(e[t[0]]),n=["Net drawdown in %"],l=["Peak date","Valley date","Recovery date"];return r.a.createElement(T.a,{striped:!0,bordered:!0,condensed:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,w.a.map(t,(function(e,t){return r.a.createElement("th",{key:t},e)})))),r.a.createElement("tbody",null,w.a.map(a,(function(a){return r.a.createElement("tr",{key:a},w.a.map(t,(function(t){return r.a.createElement("td",{key:t},function(e,t){return w.a.includes(e,"0001-01-01")?"TBD":w.a.includes(l,t)?w.a.split(e,"T")[0]:w.a.includes(n,t)?e.toFixed(2)+"%":e}(e[t][a],t))})))}))))}}]),t}(r.a.Component),R=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.data,t=w.a.keys(e),a=w.a.keys(e[t[0]]);return r.a.createElement(T.a,{striped:!0,bordered:!0,condensed:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,w.a.map(t,(function(e,t){return r.a.createElement("th",{key:t},w.a.startCase(e))})))),r.a.createElement("tbody",null,w.a.map(a,(function(a){return r.a.createElement("tr",{key:a},w.a.map(t,(function(t){return r.a.createElement("td",{key:t},e[t][a])})))}))))}}]),t}(r.a.Component),X=function(e){function t(e,a){var n;return Object(c.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e,a))).state={open:!!e.defaultOpen},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(I.a,{key:this.props.title,expanded:this.state.open,onToggle:function(){}},r.a.createElement(I.a.Heading,null,r.a.createElement(I.a.Title,{className:"clicky-hover",onClick:function(){return e.setState({open:!e.state.open})}},r.a.createElement("h3",null,this.props.title," ",r.a.createElement(j.a,{style:{float:"right"},glyph:"chevron-".concat(this.state.open?"up":"down")})))),r.a.createElement(I.a.Collapse,null,this.props.children))}}]),t}(r.a.Component),z=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){if(w.a.isEmpty(this.props.data))return null;var e="/fincl/payloads/"+this.props.data.fig_file_name,t=this.props.data,a=t.p_stats,n=t.dd_table,l=["Annual return","Cumulative returns","Annual volatility","Max drawdown","Daily value at risk"],o=function(e,t){return t?w.a.includes(l,e)?(100*t).toFixed(2)+"%":t.toFixed(2):""};return a=w.a.fromPairs(w.a.map(a,(function(e,t){return[t,o(t,e)]}))),r.a.createElement("div",{className:"pnl_report"},r.a.createElement(B.a,{key:"pstats"},r.a.createElement(A.a,{md:12},r.a.createElement(X,{title:"Performance stats",defaultOpen:!0},r.a.createElement(B.a,{key:"pstats"},r.a.createElement(A.a,{md:6},r.a.createElement(q,{data:a}))),r.a.createElement("h4",null,"Drawdowns"),r.a.createElement(H,{data:n}),r.a.createElement("p",null,"Performance stats and tearsheet are calculated from EOD (end-of-day) returns series")))),r.a.createElement(B.a,{key:"symbols"},r.a.createElement(A.a,{md:12},r.a.createElement(X,{title:"Symbols table"},r.a.createElement(R,{data:P})))),r.a.createElement(B.a,{key:"tearsheet"},r.a.createElement(A.a,{md:12},r.a.createElement(X,{title:"Tearsheet",defaultOpen:!0},r.a.createElement("img",{alt:"tearsheet",src:e,width:"100%",style:{padding:"20px"}})))))}}]),t}(r.a.Component),Y=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){if(w.a.isEmpty(this.props.data))return null;var e=w.a.get(this.props,"data.classifier","random_forest"),t=G[e];return r.a.createElement("p",null,"The classification report describes the signal generated by a ",r.a.createElement("strong",null,t)," classifier. The predictions fall between ",r.a.createElement("code",null,"{-1,1} {short,long}"),", with label targets ",r.a.createElement("code",null,"{-1,1} {negative,positive}")," indicating the returns over the forecast horizon.")}}]),t}(r.a.Component),K=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){if(w.a.isEmpty(this.props.data))return null;var e=w.a.omit(this.props.data.hyper_params,["n_jobs"]);return e=w.a.fromPairs(w.a.map(e,(function(e,t){return[t,(a=e,a%1===0?e:e.toFixed(2))];var a}))),r.a.createElement("div",null,r.a.createElement(_,{data:this.props.data.classification_report}),r.a.createElement("h5",null,"Confusion Matrix:"),r.a.createElement(Q,{data:this.props.data}),r.a.createElement(B.a,null,r.a.createElement(A.a,{md:6},r.a.createElement("h5",null,"Scores:"),r.a.createElement(U,{roc_auc_score:this.props.data.roc_auc_score,f1_score:this.props.data.f1_score})),r.a.createElement(A.a,{md:6},r.a.createElement("h5",null,"Hyper Parameters:"),r.a.createElement(q,{data:e}))))}}]),t}(r.a.Component),V=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return w.a.isEmpty(this.props.data)?null:r.a.createElement(B.a,{key:"pstats"},r.a.createElement(A.a,{md:12},r.a.createElement(X,{title:"Classification report",defaultOpen:!0},r.a.createElement(Y,{data:this.props.form_data}),r.a.createElement(K,{data:this.props.data})),r.a.createElement(X,{title:"Signals plot"},r.a.createElement(x.a,{data:D(this.props.data.pnl.signal),layout:{width:700,height:500}}))))}}]),t}(r.a.Component),W=function(e){return w.a.isEmpty(e)?{}:[{type:"bar",orientation:"h",x:w.a.map(e,"mean"),y:w.a.map(e,"k"),error_x:{type:"data",visible:!0,array:w.a.map(e,"std")}}]},J=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(l)))).renderPlot=function(e){var t=Object(F.a)(e,2),a=t[0],n=t[1];return n.length<2?null:r.a.createElement("div",{key:a},r.a.createElement("h3",null,"Window: ",a," bars"),r.a.createElement(x.a,{data:W(n),layout:{width:800,height:400}}))},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){if(w.a.isEmpty(this.props.data))return null;var e=this.props.data,t=w.a.keys(e.mean),a=w.a.map(t,(function(t){return{k:t,mean:e.mean[t],std:e.std[t]}}));a=w.a.sortBy(a,["mean"]);var n=w.a.toPairs(w.a.groupBy(a,(function(e){return w.a.split(e.k,"_")[1]})));return r.a.createElement("div",null,r.a.createElement("h2",null,"All feature importances"),r.a.createElement("p",null,"Feature importances are calculated in a parallelized manner (MDA feature importances calculated per instrument and then averaged). All features with a feature importance greater than 0 are then used for model training & evaluation."),r.a.createElement(x.a,{data:W(a),layout:{width:800,height:1e3}}),r.a.createElement("h2",null,"Feature Importances grouped by lookback window"),w.a.map(n,this.renderPlot),r.a.createElement("dl",{className:"dl-horizontal"},r.a.createElement("h3",null,"Feature definitions"),r.a.createElement("dt",null,r.a.createElement("code",null,"roll(window)")),r.a.createElement("dd",null,r.a.createElement("strong",null,"Roll measure: "),"The Roll measure attempts to estimate the bid-ask spread (i.e. liquidity) of an instrument"),r.a.createElement("dt",null,r.a.createElement("code",null,"rollimp(window)")),r.a.createElement("dd",null,r.a.createElement("strong",null,"Roll Impact: "),"The Roll measure divided by dollar volume"),r.a.createElement("dt",null,r.a.createElement("code",null,"kyle(window)")),r.a.createElement("dd",null,r.a.createElement("strong",null,"Kyle's lambda: "),"A measure of market impact cost (i.e. liquidity) from Kyle (1985)"),r.a.createElement("dt",null,r.a.createElement("code",null,"amihud(window)")),r.a.createElement("dd",null,r.a.createElement("strong",null,"Amihud's lambda: "),"A measure of market impact cost (i.e. liquidity) from Amihud (2002)"),r.a.createElement("dt",null,r.a.createElement("code",null,"auto(window, lag)")),r.a.createElement("dd",null,r.a.createElement("strong",null,"Autocorrelation: "),"The raw price series' serial correlation"),r.a.createElement("dt",null,r.a.createElement("code",null,"stdev(window)")),r.a.createElement("dd",null,r.a.createElement("strong",null,"Standard deviation: "),"The raw price series' standard deviation"),r.a.createElement("dt",null,r.a.createElement("code",null,"log()")),r.a.createElement("dd",null,r.a.createElement("strong",null,"Log prices: "),"First difference of log-transformed prices"),r.a.createElement("dt",null,r.a.createElement("code",null,"ffd(d)")),r.a.createElement("dd",null,r.a.createElement("strong",null,"Fractionally differentiated prices: "),"Achieving stationary in price series while preserving memory"),r.a.createElement("dt",null,r.a.createElement("code",null,"volratio(window)")),r.a.createElement("dd",null,r.a.createElement("strong",null,"Volume ratio: "),"Exponentially weighted MA of buy volume (as estimated by the tick rule on 1-minute bars) divided by total volume (i.e. a value greather than 0.50 indicates buyers are driving the market)")))}}]),t}(r.a.Component),Z=a(50),$=a(198),ee=a(199),te=a(196),ae=a(90),ne=a.n(ae);function re(){var e=Object(s.a)(["\n      display: block;\n      margin: 0 auto;\n      position: absolute;\n      top: -5px;\n      right: 0;\n      z-index: 100000;\n    "]);return re=function(){return e},e}var le=function(e){return"".concat(e.forecast_horizon,"_none_[]_").concat(e.classifier)},oe=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return r.a.createElement(p.a,{schema:this.props.schema,disableSubmit:!0,onUpdate:this.props.onUpdate,onSubmit:this.props.onSubmit})}}]),t}(r.a.Component),ie=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=Object(Z.css)(re());return r.a.createElement(ne.a,{css:e,size:10,color:"#ffaa00",loading:this.props.loading})}}]),t}(r.a.Component),se=function(e){return w.a.get(e,"primary.pnl.signal")?(e.primary.pnl.signal=b.a.parse(e.primary.pnl.signal,{header:!0,dynamicTyping:!0}),w.a.isEmpty(w.a.get(e,"secondary.pnl.signal",{}))||(e.secondary.pnl.signal=b.a.parse(e.secondary.pnl.signal,{header:!0,dynamicTyping:!0})),e):{}},ce=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return w.a.isEmpty(this.props.data)?null:r.a.createElement("div",{style:{position:"relative"}},r.a.createElement(ie,{loading:this.props.loading}),r.a.createElement($.a,{className:this.props.loading?"loading":"",defaultActiveKey:3,id:"uncontrolled-tab-example"},r.a.createElement(ee.a,{eventKey:1,title:"Intro"},r.a.createElement(O,null)),r.a.createElement(ee.a,{eventKey:2,title:"Feature Importance"},r.a.createElement(J,{data:this.props.data.feature_importance})),r.a.createElement(ee.a,{eventKey:3,title:"Classification Report"},r.a.createElement(V,{data:this.props.data.primary,form_data:this.props.form_data}),r.a.createElement(z,{data:this.props.data.primary.pnl}))))}}]),t}(r.a.Component),ue={form_data:{},reports:{},loading:!1},de=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).onUpdate=function(e){var t=le(e);if(!w.a.includes(t,"undefined")){var n="/fincl/payloads/f_payload_agriculture-currency-energy-equity_index-interest_rate-metals_dollar_"+t+".json",r=Object(i.a)(a);r.setState({loading:!0}),y.a.get(n).then((function(t){var a=se(t.data);r.setState({form_data:e,reports:a,loading:!1})}),(function(){}))}},a.state=ue,a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"App row justify-content-md-center"},r.a.createElement(te.a,null,r.a.createElement(B.a,null,r.a.createElement(A.a,{key:"left",md:2}),r.a.createElement(A.a,{key:"mid",md:8},r.a.createElement("div",{style:{margin:"30px 0 20px 0",textAlign:"center"}},r.a.createElement("img",{alt:"logo",src:"/fincl/fincl-logo.png",height:40})),r.a.createElement(oe,{schema:k.a,onUpdate:this.onUpdate,onSubmit:function(){}}),r.a.createElement(ce,{form_data:this.state.form_data,data:this.state.reports,loading:this.state.loading})),r.a.createElement(A.a,{key:"right",md:2})))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(de,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},36:function(e,t){e.exports={classes:{input:"form-control",select:"form-control",question:"form-group",radioListItem:"radio",radioList:"clean-list",checkboxInput:"checkbox",checkboxListItem:"checkbox",checkboxList:"clean-list",controlButton:"btn btn-primary pull-right",backButton:"btn btn-default pull-left",errorMessage:"alert alert-danger",questionPostText:"push-top",buttonBar:"button-bar"},formPanels:[{index:1,panelId:"final-panel"}],questionPanels:[{panelId:"final-panel",action:{conditions:[],default:{action:"SUBMIT"}},button:{text:"Submit"},questionSets:[{index:1,questionSetId:"info-set"}]}],questionSets:[{questionSetId:"info-set",questions:[{questionId:"classifier",question:"ML Classifier",input:{type:"selectInput",options:[{text:"Random Forest",value:"random_forest"},{text:"XGBoost",value:"xgboost"},{text:"LightGBM",value:"lgbm"},{text:"KNN",value:"knn"},{text:"Dummy (random) classifier",value:"dummy"}]}},{questionId:"forecast_horizon",question:"Forecast horizon",input:{type:"selectInput",options:[{text:"10 bars",value:"fixed_horizon_10"},{text:"25 bars",value:"fixed_horizon_25"},{text:"50 bars",value:"fixed_horizon_50"},{text:"100 bars",value:"fixed_horizon_100"}]}}]}]}},53:function(e){e.exports=JSON.parse('{"Bloomberg":{"@AD":"AD1 Curncy","@BP":"BP1 Curncy","@CD":"CD1 Curncy","@ED":"ED1 Comdty","@ES":"ES1 Index","@NQ":"NQ1 Index","@GF":"FC1 Comdty","@LE":"LC1 Comdty","@LH":"LH1 Comdty","@HE":"PE1 Curncy","@EMD":"FA1 Index","@NKD":"NX1 Index","@NE":"NV1 Curncy","@RP":"RP1 Curncy","@SP":"SP1 Index","BD":"RX1 Comdty","EZ":"DU1 Comdty","XG":"GX1 Index","EX":"VG1 Index","@YM":"YM1 Index","@BO":"BO1 Comdty","@C":"C 1 Comdty","@FV":"FV1 Comdty","@TY":"TY1 Comdty","@TU":"TU1 Comdty","@UB":"UB1 Comdty","@O":"O 1 Comdty","@SM":"SM1 Comdty","@S":"S 1 Comdty","@W":"W 1 Comdty","@MME":"MES1 Index","@CC":"CC1 Comdty","@CT":"CT1 Comdty","@OJ":"JO1 Comdty","@KC":"KC1 Comdty","@SB":"SB1 Comdty","GAS":"QS1 Comdty","LF":"Z 1 Index","LG":"G 1 Comdty","QCL":"CL1 Comdty","QHO":"HO1 Comdty","QNG":"NG1 Comdty","QPA":"PA1 Comdty","QPL":"PL1 Comdty","@QG":"EO1 Comdty","@QM":"EC1 Comdty","QGC":"GC1 Comdty","QHG":"HG1 Comdty","QSI":"SI1 Comdty"},"Description":{"@AD":"Australian Dollar Futures","@BP":"British Pound Futures","@CD":"Canadian Dollar Futures","@ED":"Eurodollar  Futures CME","@ES":"S&P 500 E-Mini Futures","@NQ":"NASDAQ E-Mini Futures","@GF":"Feeder Cattle Futures","@LE":"Live Cattle Futures","@LH":"Lean Hogs Futures","@HE":"Mexican Peso Futures","@EMD":"S&P 400 MidCap E-Mini Futures","@NKD":"Nikkei 225 Futures CME","@NE":"New Zealand Dollar Futures","@RP":"Euro/British Pound Futures","@SP":"S&P 500 Futures","BD":"Euro-Bund 10-Year Futures","EZ":"Euro-Schatz 2-Year Futures","XG":"DAX Index Futures","EX":"EURO STOXX 50 Index Futures","@YM":"E-mini Dow Jones Industrial Average Index Futures","@BO":"Soybean Oil Futures","@C":"Corn Futures","@FV":"US 5-Year T-Note Futures","@TY":"US 10-Year T-Note Futures","@TU":"US 2-Year T-Note Futures","@UB":"US 30-Year Bond Futures","@O":"Oats Futures","@SM":"Soybean Meal Futures","@S":"Soybean Futures","@W":"Wheat Futures CBOT","@MME":"MSCI Emerging Markets Mini Futures","@CC":"Cocoa Futures","@CT":"Cotton #2 Futures","@OJ":"Orange Juice Futures","@KC":"Coffee \u201cC\u201d Futures","@SB":"Sugar #11 Futures","GAS":"Low Sulphur Gasoil Futures ICE","LF":"FTSE 100 Index Futures","LG":"Long Gilt Futures","QCL":"Light Crude Oil Futures NYMEX","QHO":"Heating Oil #2 Futures NYMEX","QNG":"Natural Gas Futures NYMEX","QPA":"Palladium Futures NYMEX","QPL":"Platinum Futures NYMEX","@QG":"Natural Gas E-Mini Futures","@QM":"Crude Oil E-Mini Futures NYMEX","QGC":"Gold Futures COMEX","QHG":"Copper High Grade Futures COMEX","QSI":"Silver Futures COMEX"},"Sector":{"@AD":"Currency","@BP":"Currency","@CD":"Currency","@ED":"Interest Rate","@ES":"Equity Index","@NQ":"Equity Index","@GF":"Agriculture","@LE":"Agriculture","@LH":"Agriculture","@HE":"Currency","@EMD":"Equity Index","@NKD":"Equity Index","@NE":"Currency","@RP":"Currency","@SP":"Equity Index","BD":"Interest Rate","EZ":"Interest Rate","XG":"Equity Index","EX":"Equity Index","@YM":"Equity Index","@BO":"Agriculture","@C":"Agriculture","@FV":"Interest Rate","@TY":"Interest Rate","@TU":"Interest Rate","@UB":"Interest Rate","@O":"Agriculture","@SM":"Agriculture","@S":"Agriculture","@W":"Agriculture","@MME":"Equity Index","@CC":"Agriculture","@CT":"Agriculture","@OJ":"Agriculture","@KC":"Agriculture","@SB":"Agriculture","GAS":"Energy","LF":"Equity Index","LG":"Interest Rate","QCL":"Energy","QHO":"Energy","QNG":"Energy","QPA":"Metals","QPL":"Metals","@QG":"Energy","@QM":"Energy","QGC":"Metals","QHG":"Metals","QSI":"Metals"},"Exchange":{"@AD":"Chicago Mercantile Exchange","@BP":"Chicago Mercantile Exchange","@CD":"Chicago Mercantile Exchange","@ED":"Chicago Mercantile Exchange","@ES":"Chicago Mercantile Exchange","@NQ":"Chicago Mercantile Exchange","@GF":"Chicago Mercantile Exchange","@LE":"Chicago Mercantile Exchange","@LH":"Chicago Mercantile Exchange","@HE":"Chicago Mercantile Exchange","@EMD":"Chicago Mercantile Exchange","@NKD":"Chicago Mercantile Exchange","@NE":"Chicago Mercantile Exchange","@RP":"Chicago Mercantile Exchange","@SP":"Chicago Mercantile Exchange","BD":"Eurex","EZ":"Eurex","XG":"Eurex","EX":"Eurex","@YM":"Chicago Board of Trade","@BO":"Chicago Board of Trade","@C":"Chicago Board of Trade","@FV":"Chicago Board of Trade","@TY":"Chicago Board of Trade","@TU":"Chicago Board of Trade","@UB":"Chicago Board of Trade","@O":"Chicago Board of Trade","@SM":"Chicago Board of Trade","@S":"Chicago Board of Trade","@W":"Chicago Board of Trade","@MME":"ICE Futures US Indices","@CC":"ICE Futures US Softs","@CT":"ICE Futures US Softs","@OJ":"ICE Futures US Softs","@KC":"ICE Futures US Softs","@SB":"ICE Futures US Softs","GAS":"ICE Futures Europe Commodities","LF":"ICE Futures Europe Financials","LG":"ICE Futures Europe Financials","QCL":"New York Mercantile Exchange","QHO":"New York Mercantile Exchange","QNG":"New York Mercantile Exchange","QPA":"New York Mercantile Exchange","QPL":"New York Mercantile Exchange","@QG":"New York Mercantile Exchange","@QM":"New York Mercantile Exchange","QGC":"Commodity Exchange Inc.","QHG":"Commodity Exchange Inc.","QSI":"Commodity Exchange Inc."},"multiplier":{"@AD":100000,"@BP":62500,"@CD":100000,"@ED":2500,"@ES":50,"@NQ":20,"@GF":50000,"@LE":40000,"@LH":40000,"@HE":40000,"@EMD":100,"@NKD":5,"@NE":100000,"@RP":125000,"@SP":250,"BD":1000,"EZ":1000,"XG":25,"EX":10,"@YM":5,"@BO":60000,"@C":5000,"@FV":1000,"@TY":1000,"@TU":2000,"@UB":1000,"@O":5000,"@SM":100,"@S":5000,"@W":5000,"@MME":50,"@CC":10,"@CT":50000,"@OJ":15000,"@KC":37500,"@SB":112000,"GAS":100,"LF":1000,"LG":1000,"QCL":1000,"QHO":42000,"QNG":10000,"QPA":100,"QPL":50,"@QG":2500,"@QM":500,"QGC":100,"QHG":25000,"QSI":5000},"mintick":{"@AD":0.0001,"@BP":0.0001,"@CD":0.00005,"@ED":0.005,"@ES":0.25,"@NQ":0.25,"@GF":0.00025,"@LE":0.00025,"@LH":0.00025,"@HE":0.00025,"@EMD":0.1,"@NKD":5,"@NE":0.0001,"@RP":0.00005,"@SP":0.1,"BD":0.01,"EZ":0.005,"XG":0.5,"EX":1,"@YM":1,"@BO":0.0001,"@C":0.0025,"@FV":0.0078125,"@TY":0.015625,"@TU":0.00390625,"@UB":0.03125,"@O":0.0025,"@SM":0.1,"@S":0.0025,"@W":0.0025,"@MME":0.1,"@CC":1,"@CT":0.0001,"@OJ":0.0005,"@KC":0.0005,"@SB":0.0001,"GAS":0.25,"LF":0.005,"LG":0.01,"QCL":0.01,"QHO":0.0001,"QNG":0.001,"QPA":0.1,"QPL":0.1,"@QG":0.005,"@QM":0.025,"QGC":0.1,"QHG":0.0005,"QSI":0.005}}')},70:function(e,t,a){},93:function(e,t,a){e.exports=a(190)},98:function(e,t,a){}},[[93,1,2]]]);
//# sourceMappingURL=main.c219f678.chunk.js.map